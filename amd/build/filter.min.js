define("local_wb_news/filter",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0;
/*
   * @package    local_wb_news
   * @copyright  Wunderbyte GmbH
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
const SELECTORS_ROOT='[data-id="wb-categoryfilter-instance"]',SELECTORS_ROWS='[data-id="wb-categoryfilter-items"]',SELECTORS_ITEM="[data-category]",SELECTORS_SLIDE=".carousel-item";function normalizeList(val){return(val||"").split(/[,;|]/).map((s=>s.trim())).filter(Boolean)}function updateSlidesVisibility(root){const slides=Array.from(root.querySelectorAll(SELECTORS_SLIDE));let firstVisible=null;slides.forEach((slide=>{const row=slide.querySelector(SELECTORS_ROWS),visibleCount=row?row.querySelectorAll(`${SELECTORS_ITEM}:not(.d-none)`).length:0,isActive=slide.classList.contains("active"),shouldHide=0===visibleCount;slide.classList.toggle("d-none",shouldHide),shouldHide&&isActive&&slide.classList.remove("active"),shouldHide||firstVisible||(firstVisible=slide)}));!slides.some((s=>s.classList.contains("active")&&!s.classList.contains("d-none")))&&firstVisible&&firstVisible.classList.add("active")}function setupOneCarousel(root){const items=Array.from(root.querySelectorAll(SELECTORS_ROWS)).flatMap((r=>Array.from(r.querySelectorAll(SELECTORS_ITEM)))),dropdown=function(categories,onSelect){const wrap=document.createElement("div");wrap.className="dropdown mb-3",wrap.innerHTML='\n<button class="btn btn-outline-secondary dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false" data-id="wb-categoryfilter-button">Kategorie: Alle</button>\n<ul class="dropdown-menu" data-id="wb-categoryfilter-menu"></ul>';const ul=wrap.querySelector('[data-id="wb-categoryfilter-menu"]'),add=(label,value)=>{const li=document.createElement("li"),a=document.createElement("a");a.className="dropdown-item",a.href="#",a.dataset.value=value,a.textContent=label,li.appendChild(a),ul.appendChild(li)};return add("Alle","__all__"),categories.forEach((c=>add(c,c))),wrap.addEventListener("click",(e=>{const a=e.target.closest("a.dropdown-item");if(!a)return;e.preventDefault();const value=a.dataset.value;wrap.querySelector('[data-id="wb-categoryfilter-button"]').textContent="Kategorie: "+("__all__"===value?"Alle":a.textContent),onSelect(value)})),wrap}(Array.from(new Set(items.flatMap((el=>normalizeList(el.getAttribute("data-category")))))).sort(((a,b)=>a.localeCompare(b))),(value=>{items.forEach((el=>{if("__all__"===value)return void el.classList.remove("d-none");const cats=normalizeList(el.getAttribute("data-category"));el.classList.toggle("d-none",!cats.includes(value))})),updateSlidesVisibility(root)}));root.insertBefore(dropdown,root.firstElementChild||null),updateSlidesVisibility(root)}_exports.init=()=>{Array.from(document.querySelectorAll(SELECTORS_ROOT)).forEach((root=>{root.dataset.initialized||(root.dataset.initialized="true",setupOneCarousel(root))}))}}));

//# sourceMappingURL=filter.min.js.map